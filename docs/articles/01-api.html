<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The NWM Reanalysis API • National Water Model</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../bootstrap.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../mikepkgdown.css" rel="stylesheet">
<meta property="og:title" content="The NWM Reanalysis API">
<meta property="og:description" content="nwmHistoric">
<meta property="og:image" content="https://github.com/mikejohnson51/nwmHistoric/logo.svg">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
                                                                          <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
                                                                            <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
                                                                              <![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
              <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                  </button>
                  
                  <div class="navbar-brand-container">
                    <a class="navbar-brand" href="../index.html">nwmHistoric</a>
                      <div class="info">
                        <span class="partof">National Water Model</span>
                          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
                            </div>
                              </div>
                              </div>
                              <div id="navbar" class="navbar-collapse collapse">
                                <ul class="nav navbar-nav navbar-left">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01-api.html">The NWM Reanalysis API</a>
    </li>
    <li>
      <a href="../articles/02-discovery.html">Feature Discovery</a>
    </li>
    <li>
      <a href="../articles/03-time.html">Time Aggregation</a>
    </li>
  </ul>
</li>
                                </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mikejohnson51/nwmHistoric/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
                                </ul>
</div>
<!--/.nav-collapse -->
                                          </div>
<!--/.container -->
                                          </div>
<!--/.navbar -->

      

      </header><script src="01-api_files/header-attrs-2.3/header-attrs.js"></script><script src="01-api_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The NWM Reanalysis API</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mikejohnson51/nwmHistoric/blob/master/vignettes/01-api.Rmd"><code>vignettes/01-api.Rmd</code></a></small>
      <div class="hidden name"><code>01-api.Rmd</code></div>

    </div>

    
    
<p>As part of a collaborative research effort, the multi-decadal reanalysis products from the <a href="https://water.noaa.gov/about/nwm">NOAA National Water Model</a> (versions 1.2 and 2.0) have been reformatted and exposed through <a href="https://www.cuahsi.org/">CUAHSI</a> at the <a href="https://renci.org/research/hydroshare/">RENCI computing facility</a>. This document outlines how someone can interact with the interface.</p>
<div id="tldr" class="section level3">
<h3 class="hasAnchor">
<a href="#tldr" class="anchor"></a>TL;DR</h3>
<p><code>nwmHistoric</code> allows you to extract streamflow data from the NOAA National Water Model reanalysis products by NHD Catchment Identifier or USGS NWIS siteNumber:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">nwmHistoric</span>)

<span class="co"># Extract NWM flow records for USGS-11120000</span>
<span class="no">nwis_extract</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span>(<span class="kw">siteNumber</span> <span class="kw">=</span> <span class="fl">11120000</span>)

<span class="co"># Extract NWM flow records for comid-101 and comid-17595383</span>
<span class="no">nhd_extract</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span>(<span class="kw">comid</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">101</span>,<span class="fl">17595383</span>))</pre></body></html></div>
</div>
<div id="extraction" class="section level2">
<h2 class="hasAnchor">
<a href="#extraction" class="anchor"></a>Extraction</h2>
<p>Reanalysis data can be found with the <code>readNWMdata</code> function. The API requires users to specify NHD Catchment Identifier(s) (COMID), or NWIS gage ID(s) for time series extraction.</p>
<div id="nhd-catchment-identifier-comid" class="section level3">
<h3 class="hasAnchor">
<a href="#nhd-catchment-identifier-comid" class="anchor"></a>NHD Catchment Identifier (COMID)</h3>
<p>NWM reanalysis data can be extracted by NHD Catchment Identifier(s). The following code pulls the complete reanalysis data archive for COMID 17595383, a NHD reach near Goleta, California.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">flows</span> <span class="kw">=</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span>(<span class="kw">comid</span> <span class="kw">=</span> <span class="fl">17595383</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">flows</span>)
<span class="co">#&gt;   model    comid                time flow</span>
<span class="co">#&gt; 1  NWM2 17595383 1993-01-01 00:00:00 0.21</span>
<span class="co">#&gt; 2  NWM2 17595383 1993-01-01 01:00:00 0.21</span>
<span class="co">#&gt; 3  NWM2 17595383 1993-01-01 02:00:00 0.21</span>
<span class="co">#&gt; 4  NWM2 17595383 1993-01-01 03:00:00 0.21</span>
<span class="co">#&gt; 5  NWM2 17595383 1993-01-01 04:00:00 0.21</span>
<span class="co">#&gt; 6  NWM2 17595383 1993-01-01 05:00:00 0.21</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">flows</span>)
<span class="co">#&gt; [1] 227904      4</span></pre></body></html></div>
</div>
<div id="usgs-nwis-site-number" class="section level3">
<h3 class="hasAnchor">
<a href="#usgs-nwis-site-number" class="anchor"></a>USGS NWIS Site Number</h3>
<p>Alternatively, data can be extracted using USGS NWIS site ID(s).</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">flows</span> <span class="kw">=</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span>(<span class="kw">siteNumber</span>  <span class="kw">=</span> <span class="fl">11120000</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">flows</span>)
<span class="co">#&gt;   model    comid                time flow siteNumber</span>
<span class="co">#&gt; 1  NWM2 17595429 1993-01-01 00:00:00 0.41   11120000</span>
<span class="co">#&gt; 2  NWM2 17595429 1993-01-01 01:00:00 0.41   11120000</span>
<span class="co">#&gt; 3  NWM2 17595429 1993-01-01 02:00:00 0.41   11120000</span>
<span class="co">#&gt; 4  NWM2 17595429 1993-01-01 03:00:00 0.41   11120000</span>
<span class="co">#&gt; 5  NWM2 17595429 1993-01-01 04:00:00 0.42   11120000</span>
<span class="co">#&gt; 6  NWM2 17595429 1993-01-01 05:00:00 0.42   11120000</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">flows</span>)
<span class="co">#&gt; [1] 227904      5</span></pre></body></html></div>
</div>
</div>
<div id="contraint-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#contraint-parameters" class="anchor"></a>Contraint Parameters</h2>
<div id="date-range" class="section level3">
<h3 class="hasAnchor">
<a href="#date-range" class="anchor"></a>Date Range</h3>
<p>By default, the API extracts the complete flow record for each ID. This range can constrained by providing a <code>startDate</code> and <code>endDate</code> in the form of (“YYYY-MM-DD”).</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">utc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span>(<span class="kw">comid</span> <span class="kw">=</span> <span class="fl">17595383</span>,
                   <span class="kw">startDate</span> <span class="kw">=</span> <span class="st">"2010-01-01"</span>,
                   <span class="kw">endDate</span>   <span class="kw">=</span> <span class="st">"2010-01-31"</span>)

<span class="co"># Check time dimensions</span>
<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="no">utc</span>$<span class="no">time</span>)
<span class="co">#&gt; [1] "2010-01-01 00:00:00 UTC" "2010-01-31 23:00:00 UTC"</span></pre></body></html></div>
</div>
<div id="time-zone" class="section level3">
<h3 class="hasAnchor">
<a href="#time-zone" class="anchor"></a>Time-zone</h3>
<p>NWM output is recorded in UTC. Instead, users can specify a timezone. For our COMID in Goleta, California we can request data in <code>US/Pacific</code> time. Valid times zone can be found with <code><a href="https://rdrr.io/r/base/timezones.html">OlsonNames()</a></code>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">pst</span> <span class="kw">=</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span>(<span class="kw">comid</span> <span class="kw">=</span> <span class="fl">17595383</span>,
                  <span class="kw">startDate</span> <span class="kw">=</span> <span class="st">"2010-01-01"</span>,
                  <span class="kw">endDate</span> <span class="kw">=</span> <span class="st">"2010-01-31"</span>,
                  <span class="kw">tz</span> <span class="kw">=</span> <span class="st">"US/Pacific"</span>)

<span class="co"># Check time dimensions</span>
<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="no">pst</span>$<span class="no">time</span>)
<span class="co">#&gt; [1] "2010-01-01 00:00:00 PST" "2010-01-31 23:00:00 PST"</span></pre></body></html></div>
<p>Finally, we can plot the UTC return against the PST return:</p>
<p><img src="01-api_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
</div>
<div id="model-version" class="section level3">
<h3 class="hasAnchor">
<a href="#model-version" class="anchor"></a>Model Version</h3>
<p>The reanalysis product for versions 1.2 and 2.0 of the NWM are available. By default the API extracts data from version 2.0, but data from 1.2 can be requested as well.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">pst_v12</span> <span class="kw">=</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span>(<span class="kw">comid</span> <span class="kw">=</span> <span class="fl">17595383</span>,
                      <span class="kw">startDate</span> <span class="kw">=</span> <span class="st">"2010-01-01"</span>,
                      <span class="kw">endDate</span>   <span class="kw">=</span> <span class="st">"2010-01-31"</span>,
                      <span class="kw">tz</span> <span class="kw">=</span> <span class="st">"US/Pacific"</span>,
                      <span class="kw">version</span> <span class="kw">=</span>  <span class="fl">1.2</span>)</pre></body></html></div>
<p><img src="01-api_files/figure-html/unnamed-chunk-9-1.png" width="576"> In section 2, we will look at how we can facilitate COMID and USGS NWIS discovery. In section 3 we will look at some techniques to handle time aggregations and splitting.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer></footer>
</div>

  


  </body>
</html>
